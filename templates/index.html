{% extends "base.html" %}

{% block title %}Welcome{% endblock %}

{% block body_class %}landing-page{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
{% endblock %}

{% block content %}
<div class="landing-wrapper" id="landing-root" data-login-url="{% url 'login' %}" data-admin-url="{% url 'admin:index' %}">
    <noscript>
        <div class="text-center py-5">
            <h1 class="mb-4 text-white">Welcome to the Restaurant Management System</h1>
            <p class="lead text-white-50 mb-4">
                Easily manage ingredient and shopping orders for your restaurant. Enable JavaScript to view the interactive experience.
            </p>
            <div class="alert alert-info d-inline-block text-start">
                <strong>Need an account?</strong><br>
                Ask your manager to create one. Administrators can manage users in
                <a href="{% url 'admin:index' %}" class="alert-link">Django Admin</a>.
            </div>
            <div class="mt-4">
                <a href="{% url 'login' %}" class="btn btn-primary btn-lg">Login</a>
                <a href="{% url 'contact' %}" class="btn btn-outline-light btn-lg ms-2">Contact Us</a>
            </div>
        </div>
    </noscript>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
<script type="text/babel">
const features = [
    {
        title: "Smart station workflows",
        description: "Keep every station aligned with clear order ownership, reminders, and next steps.",
        icon: "bi-collection-play",
        spotlight: "Let every station know what is next with live task timelines and context."
    },
    {
        title: "Predictive inventory insights",
        description: "Track ingredient levels and reorder windows before shortages slow down service.",
        icon: "bi-graph-up-arrow",
        spotlight: "Plan confidently with demand forecasts built for real restaurant rhythms."
    },
    {
        title: "Unified shopping requests",
        description: "Bundle shopping needs across teams into one streamlined approval flow.",
        icon: "bi-bag-check",
        spotlight: "Shop smarter by combining vendor orders and cutting duplicate runs."
    },
    {
        title: "Real-time collaboration",
        description: "Notify admins instantly when orders are updated, approved, or fulfilled.",
        icon: "bi-lightning-charge",
        spotlight: "Give your team live visibility into every ingredient and shopping order."
    }
];

const stats = [
    { value: "35%", label: "Faster order approvals" },
    { value: "24/7", label: "Inventory tracking visibility" },
    { value: "0", label: "Missed station updates" }
];

function LandingPage(props) {
    const { loginUrl, adminUrl } = props;
    const [activeFeature, setActiveFeature] = React.useState(0);

    React.useEffect(() => {
        const intervalId = window.setInterval(() => {
            setActiveFeature((prev) => (prev + 1) % features.length);
        }, 5000);

        return () => window.clearInterval(intervalId);
    }, []);

    const activeSpotlight = features[activeFeature].spotlight;

    return (
        <div className="landing-wrapper">
            <section className="landing-hero text-white position-relative">
                <div className="position-relative">
                    <span className="badge text-bg-light text-dark mb-3">Restaurant teams • 2024</span>
                    <h1>Restaurant operations without the chaos.</h1>
                    <p className="lead mb-4 text-white-50">{activeSpotlight}</p>
                    <div className="d-flex flex-wrap align-items-center gap-3">
                        <a className="btn btn-success btn-lg shadow" href={loginUrl}>
                            <i className="bi bi-play-circle me-2"></i>
                            Launch dashboard
                        </a>
                        <span className="text-white-50">Trusted by station leads and operators every single shift.</span>
                    </div>
                </div>
            </section>

            <section className="feature-grid">
                {features.map((feature, index) => (
                    <article
                        key={feature.title}
                        className={`feature-card text-white ${index === activeFeature ? "active" : ""}`}
                        onMouseEnter={() => setActiveFeature(index)}
                        onFocus={() => setActiveFeature(index)}
                        tabIndex="0"
                        role="button"
                    >
                        <i className={`bi ${feature.icon}`}></i>
                        <h3 className="h5">{feature.title}</h3>
                        <p className="mt-2 mb-0 text-white-50">{feature.description}</p>
                    </article>
                ))}
            </section>

            <section className="stat-banner text-center text-white">
                {stats.map((stat) => (
                    <div key={stat.label} className="stat-item">
                        <h3>{stat.value}</h3>
                        <p className="text-white-50 mb-0">{stat.label}</p>
                    </div>
                ))}
            </section>

            <section className="cta-card text-white">
                <h2>Invite your team to a smoother workflow.</h2>
                <p className="text-white-50 mb-4">
                    Fast approvals, crystal-clear order tracking, and one hub for every station — you're a login away.
                </p>
                <div className="d-flex flex-column flex-md-row align-items-center justify-content-center gap-3">
                    <a className="btn btn-light btn-lg text-dark" href={loginUrl}>
                        <i className="bi bi-door-open me-2"></i>
                        Log in now
                    </a>
                    <a className="btn btn-outline-light btn-lg" href={adminUrl}>
                        <i className="bi bi-person-gear me-2"></i>
                        Manage access
                    </a>
                </div>
                <p className="text-white-50 mt-4 mb-0">
                    Need an account? Ask your manager to create one, or manage users directly in Django Admin.
                </p>
            </section>
        </div>
    );
}

const rootElement = document.getElementById("landing-root");

if (rootElement) {
    const loginUrl = rootElement.dataset.loginUrl;
    const adminUrl = rootElement.dataset.adminUrl;
    const root = ReactDOM.createRoot(rootElement);
    root.render(<LandingPage loginUrl={loginUrl} adminUrl={adminUrl} />);
}
</script>
{% endblock %}
